# Creating a virtual SenseHAT on Debian
The following instructions are for Windows users without access to a SenseHAT/Raspberry PI.

⚠️ **Note**: that you **do not** have to create a virtual machine to successfully complete the unit and this activity is optional. If you do not have access to a SenseHAT and are unsure what to do, please contact your lecturer.

-------------
> The following instructions have  been **generated by ChatGPT-4.** They have not been verified by any staff. 
> NMTAFE does not provide support for this process or these instructions. If the process fails, you will need to do your own 
> troubleshooting or use the supplied `sense_hat.py` stub module. 


## Install VirtualBox

1. Download and install VirtualBox: Go to https://www.virtualbox.org/wiki/Downloads and download the latest version of VirtualBox for Windows. Install the software by following the on-screen instructions.

2. Download the Ubuntu ISO: Go to https://ubuntu.com/download/desktop and download the latest Ubuntu Desktop LTS version.

3. Create a new virtual machine in VirtualBox:
   a. Open VirtualBox and click on "New".
   b. Name the VM, choose "Linux" as the type, and select "Ubuntu (64-bit)" as the version.
   c. Set memory size to at least 2GB (2048MB).
   d. Create a virtual hard disk, choosing "VDI (VirtualBox Disk Image)" as the type and "Dynamically allocated" as the storage method. Set the size to at least 20GB.

4. Configure the virtual machine:
   a. In VirtualBox, right-click on the created VM and select "Settings".
   b. Go to the "System" section, click on the "Processor" tab, and set the number of CPUs to at least 2.
   c. Go to the "Display" section and set the video memory to 64MB.
   d. Go to the "Storage" section, click on the "Empty" CD icon, and click on the CD icon on the right side. Select "Choose/Create a Disk Image" and locate the downloaded Ubuntu ISO file.

5. Start the virtual machine and install Ubuntu:
   a. Select the VM and click "Start".
   b. Follow the Ubuntu installation process, choosing the "Erase disk and install Ubuntu" option when prompted.

6. Install the sense-hat emulator:
   a. Open the Terminal in Ubuntu and run the following commands:
      ```bash
      sudo apt-get update
      sudo apt-get upgrade
      sudo apt-get install sense-hat
      sudo apt-get install sense-emu-tools
      ```
   b. Reboot the VM by typing `sudo reboot` in the Terminal.

7. Launch the sense-hat emulator:
   a. Open the Terminal and type `sense_emu_gui` to launch the emulator.
   b. You can now start programming with the sense-hat emulator.

## Adding Python Support for SenseHAT to your VM

8. Install Python and pip:
   a. Open the Terminal in Ubuntu and run the following commands:
      ```bash
      sudo apt-get update
      sudo apt-get install python3
      sudo apt-get install python3-pip
      ```

9. Install the sense-hat library and its dependencies:
   a. In the Terminal, run the following command to install the sense-hat library:
      ```bash
      pip3 install sense-hat
      ```
   b. Install additional dependencies with these commands:
      
      ```bash
      sudo apt-get install python3-dev
      sudo apt-get install python3-setuptools
      sudo apt-get install libtiff5-dev libjpeg8-dev zlib1g-dev \
     libfreetype6-dev liblcms2-dev libwebp-dev tcl8.6-dev tk8.6-dev python3-tk
      ```

   c. Install the Python Imaging Library (PIL) fork, Pillow, by running:
      ```bash
      pip3 install Pillow
      ```

10. Verify the sense-hat library installation:
   a. In the Terminal, run `python3` to start the Python interpreter.
   b. Type `import sense_hat` and press Enter. If there are no errors, the installation was successful.
   c. Exit the Python interpreter by typing `exit()` and pressing Enter.

You can now use Python to create and run programs that utilize the sense-hat emulator.

## SSH with Putty

11. Install OpenSSH server on the virtual Linux machine:
   a. Open the Terminal in Ubuntu and run the following commands:
      ```bash
      sudo apt-get update
      sudo apt-get install openssh-server
      ```

12. Configure the SSH server and allow connections:
   a. Run `sudo nano /etc/ssh/sshd_config` in the Terminal to edit the configuration file.
   b. Find the line that starts with "PermitRootLogin" and change it to:
      ```bash
      PermitRootLogin yes
      ```
   c. Save the changes by pressing `Ctrl + X`, then `Y`, and **Enter**.
   d. Restart the SSH server with the command: `sudo systemctl restart ssh`

13. Note the IP address of the virtual machine:
   a. In the Terminal, type `ifconfig` and press Enter.
   b. Find the "inet" address under the "enp0s3" or "eth0" section and note it down. This is the IP address you will use to connect via SSH.

14. SSH from your Windows machine:
   a. Download PuTTY, an SSH client for Windows, from https://www.chiark.greenend.org.uk/~sgtatham/putty/latest.html
   b. Install and open PuTTY.
   c. In the "Host Name (or IP address)" field, enter the IP address of the virtual machine noted in step 13.
   d. Click "Open" and accept the security warning if prompted.
   e. Log in using your Ubuntu virtual machine's username and password.

15. Create a Python script for the sense-hat emulator:
   a. In the PuTTY terminal, create a new Python script by running:
      
      ```bash
      nano sense_hat_example.py
      ```
   b. Copy and paste the following example code into the editor:
      ```python
      from sense_hat import SenseHat
      import time

      sense = SenseHat()

      red = (255, 0, 0)
      green = (0, 255, 0)
      blue = (0, 0, 255)

      def show_color(color):
          sense.clear(color)
          time.sleep(1)

      show_color(red)
      show_color(green)
      show_color(blue)

      sense.clear()
      ```
   c. Save the changes by pressing Ctrl + X, then Y, and Enter.

16. Remotely run the Python script to trigger the sense-hat emulator:
    a. In the PuTTY terminal, run the following command:
      ```
      DISPLAY=:0 python3 sense_hat_example.py
      ```
     b. On your Ubuntu virtual machine, the sense-hat emulator should display the colors red, green, and blue sequentially, then clear the display.

You have now successfully created a virtual machine running Ubuntu, installed the sense-hat emulator, and remotely run a Python script to interact with the emulator using SSH.

## Or, SSH from the Windows Command Line

14. SSH from your Windows machine using the built-in SSH client:
   a. Press `Win + X` on your keyboard and select "Windows PowerShell" or "Windows Terminal" from the menu.
   b. In the PowerShell or Terminal window, type the following command, replacing `<IP_ADDRESS>` with the IP address of the virtual machine noted in step 13, and `<USERNAME>` with your Ubuntu virtual machine's username:
      ```
      ssh <USERNAME>@<IP_ADDRESS>
      ```
   c. You may see a security warning regarding the authenticity of the host. Type "yes" and press Enter to continue.
   d. Enter your Ubuntu virtual machine's password when prompted.

Now, you can follow steps 15 and 16 to create the Python script for the sense-hat emulator and remotely run the script to trigger the emulator using the built-in SSH client for Windows.
